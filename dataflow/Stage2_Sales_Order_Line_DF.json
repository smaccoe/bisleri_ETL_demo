{
	"name": "Stage2_Sales_Order_Line_DF",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Stage2_Sales_Order_Line_TB",
						"type": "DatasetReference"
					},
					"name": "SalesOrderLineSource"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "Delta_Full_Load",
						"type": "LinkedServiceReference"
					},
					"name": "SalesOrderLine",
					"rejectedDataLinkedService": {
						"referenceName": "Delta_Full_Load",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [
				{
					"name": "select1"
				},
				{
					"name": "Cleaning"
				}
			],
			"scriptLines": [
				"parameters{",
				"     Container_Name as string ('delta-lake'),",
				"     Folder_Name as string ( 'Transaction/Full-Load')",
				"}",
				"source(output(",
				"          SO_BillNo as string,",
				"          SO_Bill_CustomerNo as string,",
				"          SO_Completely_Shipped as string,",
				"          SO_DocumentDate as string,",
				"          SO_DocumentNo as string,",
				"          SO_DocType as string,",
				"          SO_FreeSupply as string,",
				"          SO_ItemCategory as string,",
				"          SO_ItemSubCategory as string,",
				"          SO_LineNo as string,",
				"          SO_Location as string,",
				"          SO_ItemNo as string,",
				"          SO_Item_Name as string,",
				"          SO_OrderQty as string,",
				"          SO_OrderUOM as string,",
				"          SO_PackSize as string,",
				"          SO_Qty_Shp_Not_INV as string,",
				"          SO_Qty_To_INV as string,",
				"          SO_Qty_To_Ship as string,",
				"          SO_Qty as string,",
				"          SO_Qty_Inv as string,",
				"          SO_Qty_Shipped as string,",
				"          SO_Route_SalesNo as string,",
				"          SO_Amt_To_Customer as string,",
				"          SO_SchemeReason as string,",
				"          SO_SellingPrice as string,",
				"          SO_Non_DispatchReason as string,",
				"          SO_Blanket_OrderNo as string,",
				"          SO_Branch as string,",
				"          SO_Reason_Code as string,",
				"          SO_Order_Placed as string,",
				"          SO_Order_PlacedBy as string,",
				"          SO_Order_Placed_On as string,",
				"          SO_Dispatch_Location as string,",
				"          SO_Division as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> SalesOrderLineSource",
				"SalesOrderLineSource select(mapColumn(",
				"          SO_BillNo,",
				"          SO_Bill_CustomerNo,",
				"          SO_Completely_Shipped,",
				"          SO_DocumentDate,",
				"          SO_DocumentNo,",
				"          SO_DocType,",
				"          SO_FreeSupply,",
				"          SO_ItemCategory,",
				"          SO_ItemSubCategory,",
				"          SO_LineNo,",
				"          SO_Location,",
				"          SO_ItemNo,",
				"          SO_Item_Name,",
				"          SO_OrderQty,",
				"          SO_OrderUOM,",
				"          SO_PackSize,",
				"          SO_Qty_Shp_Not_INV,",
				"          SO_Qty_To_INV,",
				"          SO_Qty_To_Ship,",
				"          SO_Qty,",
				"          SO_Qty_Inv,",
				"          SO_Qty_Shipped,",
				"          SO_Route_SalesNo,",
				"          SO_Amt_To_Customer,",
				"          SO_SchemeReason,",
				"          SO_SellingPrice,",
				"          SO_Non_DispatchReason,",
				"          SO_Blanket_OrderNo,",
				"          SO_Branch,",
				"          SO_Reason_Code,",
				"          SO_Order_Placed,",
				"          SO_Order_PlacedBy,",
				"          SO_Order_Placed_On,",
				"          SO_Dispatch_Location,",
				"          SO_Division",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"select1 derive(SO_BillNo = toInteger(SO_BillNo),",
				"          SO_Bill_CustomerNo = iifNull(SO_Bill_CustomerNo, toString(null())),",
				"          SO_Completely_Shipped = toInteger(SO_Completely_Shipped),",
				"          SO_DocumentDate = toTimestamp(SO_DocumentDate,'dd/MM/yyyy hh:mm:ss a','UTC','yyyy-MM-dd hh:mm:ss a'),",
				"          SO_DocumentNo = iifNull(SO_DocumentNo, toString(null())),",
				"          SO_DocType = toInteger(SO_DocType),",
				"          SO_FreeSupply = toInteger(SO_FreeSupply),",
				"          SO_ItemCategory = iifNull(SO_ItemCategory, toString(null())),",
				"          SO_ItemSubCategory = iifNull(SO_ItemSubCategory, toString(null())),",
				"          SO_LineNo = toInteger(SO_LineNo),",
				"          SO_Location = iifNull(SO_Location, toString(null())),",
				"          SO_ItemNo = iifNull(SO_ItemNo, toString(null())),",
				"          SO_Item_Name = iifNull(SO_Location, toString(null())),",
				"          SO_OrderQty = toDouble(SO_OrderQty),",
				"          SO_OrderUOM = iifNull(SO_OrderUOM, toString(null())),",
				"          SO_PackSize = iifNull(SO_PackSize, toString(null())),",
				"          SO_Qty_Shp_Not_INV = toInteger(SO_Qty_Shp_Not_INV),",
				"          SO_Qty_To_INV = toInteger(SO_Qty_To_INV),",
				"          SO_Qty_To_Ship = toInteger(SO_Qty_To_Ship),",
				"          SO_Qty = toDouble(SO_Qty),",
				"          SO_Qty_Inv = toDouble(SO_Qty_Inv),",
				"          SO_Qty_Shipped = toDouble(SO_Qty_Shipped),",
				"          SO_Route_SalesNo = iifNull(SO_Route_SalesNo, toString(null())),",
				"          SO_Amt_To_Customer = toDouble(SO_Amt_To_Customer),",
				"          SO_SchemeReason = iifNull(SO_SchemeReason, toString(null())),",
				"          SO_SellingPrice = toDouble(SO_SellingPrice),",
				"          SO_Non_DispatchReason = iifNull(SO_Non_DispatchReason, toString(null())),",
				"          SO_Blanket_OrderNo = iifNull(SO_Blanket_OrderNo, toString(null())),",
				"          SO_Branch = iifNull(SO_Branch, toString(null())),",
				"          SO_Reason_Code = iifNull(SO_Reason_Code, toString(null())),",
				"          SO_Order_Placed = toInteger(SO_Order_Placed),",
				"          SO_Order_PlacedBy = iifNull(SO_Order_PlacedBy, toString(null())),",
				"          SO_Order_Placed_On = toTimestamp(SO_Order_Placed_On,'dd/MM/yyyy hh:mm:ss a','UTC','yyyy-MM-dd hh:mm:ss a'),",
				"          SO_Dispatch_Location = iifNull(SO_Dispatch_Location, toString(null())),",
				"          SO_Division = iifNull(SO_Division, toString(null()))) ~> Cleaning",
				"Cleaning sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'delta',",
				"     fileSystem: ($Container_Name),",
				"     folderPath: ($Folder_Name),",
				"     mergeSchema: false,",
				"     autoCompact: false,",
				"     optimizedWrite: false,",
				"     vacuum: 0,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SalesOrderLine"
			]
		}
	}
}