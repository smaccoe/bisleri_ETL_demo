{
	"name": "Customer_Master_DF",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Customer_Master",
						"type": "DatasetReference"
					},
					"name": "customersource"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "columnrename"
				},
				{
					"name": "datacleaning"
				}
			],
			"scriptLines": [
				"source(output(",
				"          Customer_No as string,",
				"          Cust_Creation_Date as string,",
				"          Cust_Name as string,",
				"          {Search Name} as string,",
				"          {Name 2} as string,",
				"          {Phone No_2} as string,",
				"          Territory_SH as string,",
				"          Cust_Resd_Phone_no as string,",
				"          Cust_Mobile_no as string,",
				"          Address as string,",
				"          {Address 2} as string,",
				"          City as string,",
				"          PAN_NO as string,",
				"          TIN_NO as string,",
				"          Contact as string,",
				"          {Phone No_} as string,",
				"          {Telex No_} as string,",
				"          Cust_Fax_No as string,",
				"          {Our Account No_} as string,",
				"          {Territory Code} as string,",
				"          {Global Dimension 1 Code} as string,",
				"          {Global Dimension 2 Code} as string,",
				"          {Chain Name} as string,",
				"          {Lead generated by} as string,",
				"          Route as string,",
				"          Cust_Route_Name as string,",
				"          SalesCode as string,",
				"          SalesName as string,",
				"          {Budgeted Amount} as string,",
				"          {Credit Limit (LCY)} as string,",
				"          {Customer Posting Group} as string,",
				"          {Currency Code} as string,",
				"          {Customer Price Group} as string,",
				"          {Language Code} as string,",
				"          {Statistics Group} as string,",
				"          {Payment Terms Code} as string,",
				"          {Fin_ Charge Terms Code} as string,",
				"          {Salesperson Code} as string,",
				"          Cust_Invoice_Disc_Code as string,",
				"          Cust_Disc_Group as string,",
				"          {Country Code} as string,",
				"          {Collection Method} as string,",
				"          {Creation Date Time} as string,",
				"          Cust_Last_Date_Modified as string,",
				"          {Customer Category} as string,",
				"          {Customer Group Code} as string,",
				"          Customer_Area as string,",
				"          Zone as string,",
				"          District as string,",
				"          {Sub Zone} as string,",
				"          Cust_Division as string,",
				"          Cust_Zone_IN_Charge_code as string,",
				"          Posting_Group as string,",
				"          Cust_posting_Group as string,",
				"          Cust_gen_bus_Posting_Grp as string,",
				"          Cust_subcategory_code as string,",
				"          Cust_type as string,",
				"          {Executive Code} as string,",
				"          Cust_Executive_Name as string,",
				"          {Manager Code} as string,",
				"          Cust_Manager_name as string,",
				"          cust_parent_group as string,",
				"          payment_method_code as string,",
				"          Cust_sales_area_Div as string,",
				"          Cust_Structure as string,",
				"          A_S_M_ as string,",
				"          Cust_ASM_Name as string,",
				"          {Active Customer} as string,",
				"          {Customer Channel} as string,",
				"          {A_S_M Name} as string,",
				"          {Post Code} as string,",
				"          {E-Mail} as string,",
				"          {Urzza Display Outlet} as string,",
				"          Cust_Creadit_Limit_Active as string,",
				"          {Activate Credit Limit Days} as string,",
				"          {Billing Type} as string,",
				"          Cust_Scheme_Applicable as string,",
				"          Cust_Ceration_User_ID as string,",
				"          SGA as string,",
				"          Created_From_Source as string,",
				"          BT_Monday as string,",
				"          BT_Tuesday as string,",
				"          BT_Wednesday as string,",
				"          BT_Thursday as string,",
				"          BT_Friday as string,",
				"          BT_Saturday as string,",
				"          BT_Sunday as string,",
				"          {BT_Week-1} as string,",
				"          {BT_Week-2} as string,",
				"          {BT_Week-3} as string,",
				"          {BT_Week-4} as string,",
				"          {Exclude Cust} as string,",
				"          DLP as string,",
				"          {DLP Slab} as string,",
				"          LOCATIONFLAG as string,",
				"          Channel as string,",
				"          {Sub-Channel 1} as string,",
				"          {Sub-Channel 2} as string,",
				"          {Sub-Channel 3} as string,",
				"          Remaining_Amt as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> customersource",
				"customersource select(mapColumn(",
				"          Customer_No,",
				"          Cust_Creation_Date,",
				"          Cust_Name,",
				"          Search_Name = {Search Name},",
				"          Name_2 = {Name 2},",
				"          Phone_No_2 = {Phone No_2},",
				"          Territory_SH,",
				"          Cust_Resd_Phone_no,",
				"          Cust_Mobile_no,",
				"          Address,",
				"          Address_2 = {Address 2},",
				"          City,",
				"          PAN_NO,",
				"          TIN_NO,",
				"          Contact,",
				"          Phone_No_ = {Phone No_},",
				"          Telex_No_ = {Telex No_},",
				"          Cust_Fax_No,",
				"          Our_Account_No_ = {Our Account No_},",
				"          Territory_Code = {Territory Code},",
				"          Global_Dimension1_Code = {Global Dimension 1 Code},",
				"          Global_Dimension2_Code = {Global Dimension 2 Code},",
				"          Chain_Name = {Chain Name},",
				"          Lead_generated_by = {Lead generated by},",
				"          Route,",
				"          Cust_Route_Name,",
				"          SalesCode,",
				"          SalesName,",
				"          Budgeted_Amount = {Budgeted Amount},",
				"          Credit_Limit_LCY = {Credit Limit (LCY)},",
				"          Customer_Posting_Group = {Customer Posting Group},",
				"          Currency_Code = {Currency Code},",
				"          Customer_Price_Group = {Customer Price Group},",
				"          Language_Code = {Language Code},",
				"          Statistics_Group = {Statistics Group},",
				"          Payment_Terms_Code = {Payment Terms Code},",
				"          Fin_Charge_Terms_Code = {Fin_ Charge Terms Code},",
				"          Salesperson_Code = {Salesperson Code},",
				"          Cust_Invoice_Disc_Code,",
				"          Cust_Disc_Group,",
				"          Country_Code = {Country Code},",
				"          Collection_Method = {Collection Method},",
				"          Creation_Date_Time = {Creation Date Time},",
				"          Cust_Last_Date_Modified,",
				"          Customer_Category = {Customer Category},",
				"          Customer_Group_Code = {Customer Group Code},",
				"          Customer_Area,",
				"          Zone,",
				"          District,",
				"          Sub_Zone = {Sub Zone},",
				"          Cust_Division,",
				"          Cust_Zone_IN_Charge_code,",
				"          Posting_Group,",
				"          Cust_posting_Group,",
				"          Cust_gen_bus_Posting_Grp,",
				"          Cust_subcategory_code,",
				"          Cust_type,",
				"          Executive_Code = {Executive Code},",
				"          Cust_Executive_Name,",
				"          {Manager _Code} = {Manager Code},",
				"          Cust_Manager_name,",
				"          cust_parent_group,",
				"          payment_method_code,",
				"          Cust_sales_area_Div,",
				"          Cust_Structure,",
				"          A_S_M_,",
				"          Cust_ASM_Name,",
				"          Active_Customer = {Active Customer},",
				"          Customer_Channel = {Customer Channel},",
				"          A_S_M_Name = {A_S_M Name},",
				"          Post_Code = {Post Code},",
				"          E_Mail = {E-Mail},",
				"          Urzza_Display_Outlet = {Urzza Display Outlet},",
				"          Cust_Creadit_Limit_Active,",
				"          Activate_Credit_Limit_Days = {Activate Credit Limit Days},",
				"          Billing_Type = {Billing Type},",
				"          Cust_Scheme_Applicable,",
				"          Cust_Ceration_User_ID,",
				"          SGA,",
				"          Created_From_Source,",
				"          BT_Monday,",
				"          BT_Tuesday,",
				"          BT_Wednesday,",
				"          BT_Thursday,",
				"          BT_Friday,",
				"          BT_Saturday,",
				"          BT_Sunday,",
				"          {BT_Week-1},",
				"          {BT_Week-2},",
				"          {BT_Week-3},",
				"          {BT_Week-4},",
				"          Exclude_Cust = {Exclude Cust},",
				"          DLP,",
				"          DLP_Slab = {DLP Slab},",
				"          LOCATIONFLAG,",
				"          Channel,",
				"          {Sub-Channel_1} = {Sub-Channel 1},",
				"          {Sub-Channel_2} = {Sub-Channel 2},",
				"          {Sub-Channel_3} = {Sub-Channel 3},",
				"          Remaining_Amt",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> columnrename",
				"columnrename derive(Cust_Creation_Date = toTimestamp(Cust_Creation_Date,'dd/MM/yyyy hh:mm:ss a','UTC','yyyy-MM-dd hh:mm:ss a'),",
				"          Cust_Name = iifNull(Cust_Name,toString(null())),",
				"          Search_Name = iifNull(Search_Name,toString(null())),",
				"          Name_2 = iifNull(Name_2,toString(null())),",
				"          Territory_SH = iifNull(Territory_SH,toString(null())),",
				"          Phone_No_2 = toInteger(Phone_No_2),",
				"          Cust_Resd_Phone_no = toInteger(iifNull(Cust_Resd_Phone_no, toString(null()))),",
				"          Cust_Mobile_no = toInteger(iifNull(Cust_Mobile_no,toString(null()))),",
				"          Address = iifNull(Address,toString(null())),",
				"          Address_2 = iifNull(Address_2,toString(null())),",
				"          City = iifNull(City,toString(null())),",
				"          PAN_NO = iifNull(PAN_NO,toString(null())),",
				"          TIN_NO = iifNull(TIN_NO,toString(null())),",
				"          Contact = iifNull(Contact,toString(null())),",
				"          Phone_No_ = toInteger(iifNull(Phone_No_,toString(null()))),",
				"          Telex_No_ = toInteger(iifNull(Telex_No_,toString(null()))),",
				"          Cust_Fax_No = toInteger(iifNull(Cust_Fax_No,toString(null()))),",
				"          Our_Account_No_ = toInteger(iifNull(Our_Account_No_,toString(null()))),",
				"          Territory_Code = iifNull(Territory_Code,toString(null())),",
				"          Global_Dimension1_Code = iifNull(Global_Dimension1_Code,toString(null())),",
				"          Global_Dimension2_Code = iifNull(Global_Dimension2_Code,toString(null())),",
				"          Chain_Name = iifNull(Chain_Name,toString(null())),",
				"          Lead_generated_by = iifNull(Lead_generated_by,toString(null())),",
				"          Route = iifNull(Route,toString(null())),",
				"          Cust_Route_Name = iifNull(Cust_Route_Name,toString(null())),",
				"          SalesCode = iifNull(SalesCode,toString(null())),",
				"          SalesName = iifNull(SalesName,toString(null())),",
				"          Customer_Posting_Group = iifNull(Customer_Posting_Group,toString(null())),",
				"          Currency_Code = iifNull(Currency_Code,toString(null())),",
				"          Customer_Price_Group = iifNull(Customer_Price_Group,toString(null())),",
				"          Language_Code = iifNull(Language_Code,toString(null())),",
				"          Statistics_Group =  toInteger(iifNull(Statistics_Group,toString(null()))),",
				"          Payment_Terms_Code = iifNull(Payment_Terms_Code,toString(null())),",
				"          Fin_Charge_Terms_Code = iifNull(Fin_Charge_Terms_Code,toString(null())),",
				"          Salesperson_Code = iifNull(Salesperson_Code,toString(null())),",
				"          Cust_Invoice_Disc_Code = iifNull(Cust_Invoice_Disc_Code,toString(null())),",
				"          Cust_Disc_Group = iifNull(Cust_Disc_Group,toString(null())),",
				"          Country_Code = iifNull(Country_Code,toString(null())),",
				"          Collection_Method = iifNull(Collection_Method,toString(null())),",
				"          Creation_Date_Time = toTimestamp(Creation_Date_Time,'dd/MM/yyyy hh:mm:ss a','UTC','yyyy-MM-dd hh:mm:ss a'),",
				"          Cust_Last_Date_Modified = toTimestamp(Cust_Last_Date_Modified,'dd/MM/yyyy hh:mm:ss a','UTC','yyyy-MM-dd hh:mm:ss a'),",
				"          Customer_Category = iifNull(Customer_Category,toString(null())),",
				"          Customer_Group_Code = iifNull(Customer_Group_Code,toString(null())),",
				"          Customer_Area = iifNull(Customer_Area,toString(null())),",
				"          Zone = iifNull(Zone,toString(null())),",
				"          District = iifNull(District,toString(null())),",
				"          Sub_Zone = iifNull(Sub_Zone,toString(null())),",
				"          Cust_Division = iifNull(Cust_Division,toString(null())),",
				"          Posting_Group = iifNull(Posting_Group,toString(null())),",
				"          Cust_posting_Group = iifNull(Cust_posting_Group,toString(null())),",
				"          Cust_gen_bus_Posting_Grp = iifNull(Cust_gen_bus_Posting_Grp,toString(null())),",
				"          Cust_subcategory_code = iifNull(Cust_subcategory_code,toString(null())),",
				"          Cust_type = iifNull(Cust_type,toString(null())),",
				"          Executive_Code = iifNull(Executive_Code,toString(null())),",
				"          Cust_Executive_Name = iifNull(Cust_Executive_Name,toString(null())),",
				"          {Manager _Code} = iifNull({Manager _Code},toString(null())),",
				"          Cust_Manager_name = iifNull(Cust_Manager_name,toString(null())),",
				"          cust_parent_group = iifNull(cust_parent_group,toString(null())),",
				"          payment_method_code = iifNull(payment_method_code,toString(null())),",
				"          Cust_sales_area_Div = iifNull(Cust_sales_area_Div,toString(null())),",
				"          Cust_Structure = iifNull(Cust_Structure,toString(null())),",
				"          A_S_M_ = iifNull(A_S_M_,toString(null())),",
				"          Cust_ASM_Name = iifNull(Cust_ASM_Name,toString(null())),",
				"          Active_Customer = toInteger(iifNull({Active_Customer},toString(null()))),",
				"          Customer_Channel = toInteger(iifNull({Customer_Channel},toString(null()))),",
				"          A_S_M_Name = iifNull({A_S_M_Name},toString(null())),",
				"          Post_Code = toInteger(iifNull({Post_Code},toString(null()))),",
				"          E_Mail = iifNull({E_Mail},toString(null())),",
				"          Urzza_Display_Outlet = iifNull({Urzza_Display_Outlet},toString(null())),",
				"          Cust_Creadit_Limit_Active = iifNull({Cust_Creadit_Limit_Active},toString(null())),",
				"          Activate_Credit_Limit_Days = ERROR_FUNCTION('')) ~> datacleaning"
			]
		}
	}
}